<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form</title>
    <link rel="stylesheet" href="CSS/form.css" />
    <style>
        .btn-toggle {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 15px;
            width: 10rem;
        }

        .btn-toggle:hover {
            background-color: #0056b3;
        }

        input[type="number"], textarea {
            width: 50%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #b0b0c0;
            border-radius: 7px;
            font-size: 16px;
        }

        .label-tog {
            display: inline-block;
            width: 150px;
            font-weight: bold;
            margin-right: 10px;
        }
        textarea {
            height: 50px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>

<body>

    <div id="page" class="site">
        <div class="titl">
            <div class="left-section" style="display: flex; align-items: center;">
                <img class="imgico" src="Assests/img/person.png" alt="image" style="margin-right: 10px;">
                <p class="txt1">ADD Data</p>
            </div>
            <a href="index.html" class="home-button" title="Home">
                <img src="Assests/img/home-icon.png" alt="Home" class="home-icon">
            </a>
        </div>

        <div class="container">

            <div class="form-box">
                <form action="php/form.php" method="post" enctype="multipart/form-data" autocomplete="off">
                    <div class="form-one form-step active">
                        <div class="bg-svg"></div>
                        <h2>Enter Information</h2>
                        <p>enter information correctly</p>
                        <div>
                            <label for="reg_id">ලියාපදිංචි අංකය :</label>
                            <input type="text" id="reg_id" name="reg_id" required>
                            <span id="reg_id_error" style="color: red; display: none;">ID already exists.</span>
                        </div>
                        <div>
                            <label for="dis">දිස්ත්‍රික්කය :</label>
                            <input list="dist" id="dis" name="dis" placeholder="විකල්පයක් තෝරන්න" required>
                            <datalist id="dist">
                                <option value="ගාල්ල">
                                <option value="මාතර">
                                <option value="හම්බන්තොට">
                            </datalist>
                        </div>
                        
                        <div>
                            <label for="divi">කොට්ඨාසය :</label>
                            <input list="divi-list" id="divi" name="divi" required placeholder="විකල්පයක් තෝරන්න">
                            <datalist id="divi-list">
                            </datalist>
                        </div>
                    
                        <div>
                            <label for="village">ග්‍රාම නිලධාරී වසම :</label>
                            <input type="text" name="village" id="village">
                        </div>

                        <div>
                            <label for="club_name">ක්‍රීඩා සමාජයේ නම :</label>
                            <input type="text" name="club_name" id="club_name">
                        </div>

                        <div>
                            <label for="c_name">සභාපතිගේ නම හා ලිපිනය :</label>
                            <input type="text" name="c_name" id="c_name">
                        </div>

                        <div>
                            <label for="sec_name">ලේකම්ගේ නම හා ලිපිනය :</label>
                            <input type="text" name="sec_name" id="sec_name">
                        </div>

                        <div>
                            <button type="button" id="toggle-fields-btn" class="btn-toggle">ක්‍රීඩා උපකරණ</button>
                        </div>
                        
                        <div class="" id="sports-fields" style="display: none;">
                            <div>
                                <label for="voli" class="label-tog">වොලිබෝල් :</label>
                                <input type="number" name="voli" id="voli">
                            </div>
                            <div>
                                <label for="net" class="label-tog">වොලිබෝල් නෙට් :</label>
                                <input type="number" name="net" id="net">
                            </div>
                            <div>
                                <label for="nb" class="label-tog">නෙට්බෝල් :</label>
                                <input type="number" name="nb" id="nb">
                            </div>
                            <div>
                                <label for="foot" class="label-tog">ෆුට්බෝල් :</label>
                                <input type="number" name="foot" id="foot">
                            </div>
                            <div>
                                <label for="teni" class="label-tog">ටෙනිස් බෝල් :</label>
                                <input type="number" name="teni" id="teni">
                            </div>
                            <div>
                                <label for="bat" class="label-tog">ක්‍රිකට් බැට් :</label>
                                <input type="number" name="bat" id="bat">
                            </div>
                            <div>
                                <label for="wik" class="label-tog">විකට් සෙට් :</label>
                                <input type="number" name="wik" id="wik">
                            </div>
                            <div>
                                <label for="eq" class="label-tog">වෙනත් ක්‍රීඩා උපකරණ :</label>
                                <textarea name="eq" id="eq"></textarea>
                            </div>
                        </div>

                        <div>
                            <label for="reg_date">ලියාපදිංචි දිනය :</label>
                            <input type="date" id="reg_date" name="reg_date" placeholder="YYYY-MM-DD">
                        </div>
                        <div>
                            <label for="reco_date">ප්‍රතිසංවිධාන දිනය :</label>
                            <input type="date" id="reco_date" name="reco_date" placeholder="">
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn-submit" id="submit-btn">submit</button>
                    </div>
            </div>
            </form>
        </div>
    </div>
    </div>
    <script>
        document.getElementById('reg_id').addEventListener('blur', function () {
                const regId = this.value;
                const regIdError = document.getElementById('reg_id_error');
                const submitButton = document.getElementById('submit-btn');

                if (regId) {
                    fetch(`php/check_id.php?reg_id=${regId}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.exists) {
                                regIdError.style.display = 'block'; 
                                this.classList.add('error');  
                                submitButton.disabled = true; 
                            } else {
                                regIdError.style.display = 'none';
                                this.classList.remove('error');  
                                submitButton.disabled = false; 
                            }
                        })
                        .catch(error => console.error('Error checking reg_id:', error));
                } else {
                    regIdError.style.display = 'none';  
                    submitButton.disabled = false; 
                }
            });

        document.getElementById('dis').addEventListener('input', function () {
                const district = this.value;
                const diviInput = document.getElementById('divi');
                const diviList = document.getElementById('divi-list');

                if (district) {
                    fetch(`php/fetch_divi.php?district=${district}`)
                        .then(response => response.json())
                        .then(data => {
                            diviList.innerHTML = ''; 
                            data.forEach(item => {
                                const option = document.createElement('option');
                                option.value = item.name; 
                                diviList.appendChild(option);
                            });
                        })
                        .catch(error => console.error('Error loading divis:', error));
                } else {
                    diviList.innerHTML = '';
                }
            });


        document.addEventListener('DOMContentLoaded', () => {
                const urlParams = new URLSearchParams(window.location.search);

                if (urlParams.get('success')) {
                    alert('Record created successfully!');
                }

                if (urlParams.get('error') === 'duplicate') {
                    alert('The ID already exists. Please enter a unique ID.');
                }

                if (urlParams.get('success') || urlParams.get('error')) {
                    history.replaceState(null, '', window.location.pathname);
                }
            });

            document.getElementById('toggle-fields-btn').addEventListener('click', function () {
                    const sportsFields = document.getElementById('sports-fields');
                    const isHidden = sportsFields.style.display === 'none';

                    if (isHidden) {
                        sportsFields.style.display = 'block';
                        this.textContent = 'ක්‍රීඩා උපකරණ';
                    } else {
                        sportsFields.style.display = 'none';
                        this.textContent = 'ක්‍රීඩා උපකරණ';
                    }
                });                                      


    </script>
</body>

</html>